(function(e){function t(t){for(var s,a,r=t[0],c=t[1],l=t[2],d=0,h=[];d<r.length;d++)a=r[d],i[a]&&h.push(i[a][0]),i[a]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(h.length)h.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],s=!0,r=1;r<n.length;r++){var c=n[r];0!==i[c]&&(s=!1)}s&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var s={},i={app:0},o=[];function a(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=s,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"24c7":function(e,t,n){},2856:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var s=n("2b0e"),i=n("0086"),o=n.n(i),a=n("37c3"),r=n.n(a),c=n("498a"),l=n("9ae9"),u=n("cbd0"),d=n("1073"),h=n("b1fc"),f=n("3d31"),m=n("44d4"),p=n("7049"),g=n("8b3d"),v=n("dbbe"),y=n("f7ca"),w=n("f9bc"),b=n("88d4"),k=(n("ab8b"),n("ecee")),_=n("c074"),S=n("ad3d"),x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"title"}},[n("h1",[e._v(" simple flowchart")]),n("button",{on:{click:function(t){e.isPanelShow=!e.isPanelShow}}},[e._v(e._s(e.isPanelShow?"Hide Panel":"Show Panel"))]),e.isPanelShow?n("button",{on:{click:function(t){e.isRawScene=!e.isRawScene}}},[e._v(e._s(e.isRawScene?"Show Pretty":"Show Raw"))]):e._e(),e.isPanelShow?n("div",{staticClass:"panel-area"},[n("div",{staticClass:"extraction-panel",domProps:{innerHTML:e._s(e.isRawScene?e.rawScene:e.prettyScene)}})]):e._e()]),n("br"),n("div",{staticClass:"flowchart"},[n("h2",{staticStyle:{"overflow-x":"auto"}},e._l(e.stages,function(t,s){return n("nobr",{key:s},[n("b-button",{attrs:{variant:"outline-dark",size:"lg"},on:{click:function(t){e.newStageType=s,e.$bvModal.show("createModal")}}},[e._v("\n          "+e._s(t.name)+"\n        ")]),e._v("\n         \n        "),parseInt(s)+1<Object.keys(e.stages).length?n("font-awesome-icon",{attrs:{icon:["fas","arrow-right"],size:"lg"}}):e._e(),e._v("\n         \n      ")],1)}),1),n("b-row",{attrs:{"align-h":"end"}},[n("b-col",{attrs:{sm:"1"}},[n("label",[e._v("Scale:")])]),n("b-col",{attrs:{sm:"3"}},[n("b-form-input",{attrs:{type:"range",min:"0",max:"1",step:"0.1"},model:{value:e.scene.scale,callback:function(t){e.$set(e.scene,"scale",t)},expression:"scene.scale"}})],1)],1),n("simple-flowchart",{attrs:{scene:e.scene,verifyNode:e.verifyNode,openDrawer:e.openDrawer,resetNodeStatFromID:e.resetNodeStatFromID,stages:e.stages,height:1200},on:{"update:scene":function(t){e.scene=t},nodeClick:e.nodeClick,nodeDelete:e.nodeDelete,linkBreak:e.linkBreak,linkAdded:e.linkAdded,canvasClick:e.canvasClick,"update:stages":function(t){e.stages=t}}})],1),n("b-modal",{ref:"createModal",staticClass:"modal-backdrop fade",attrs:{id:"createModal",title:"New Node","hide-footer":"","hide-backdrop":""}},[n("b-form",{staticClass:"w-100",on:{submit:e.onCreateFormSubmit,reset:e.onCreateFormReset}},[n("b-form-select",{staticClass:"mb-3",attrs:{required:""},model:{value:e.newNodeType,callback:function(t){e.newNodeType=t},expression:"newNodeType"}},[n("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("Please select a node type")]),e._l(e.nodeInStage(parseInt(e.newStageType)),function(t,s){return n("b-form-select-option",{key:"category-"+s,attrs:{value:s}},[e._v("\n          "+e._s(t.name)+"\n        ")])})],2),n("br"),n("b-button-group",[n("b-button",{attrs:{type:"submit",variant:"primary"}},[n("b",[e._v("Submit")])]),e._v("\n         \n        "),n("b-button",{attrs:{type:"reset",variant:"danger"}},[n("b",[e._v("Cancel")])])],1)],1)],1),e._l(e.scene.nodes,function(t){return n("Drawer",{key:"drawer_"+t.id,ref:"drawer_"+t.id,refInFor:!0,attrs:{direction:"left",exist:!0}},[n("div",[n("b-jumbotron",{staticClass:"text-left",style:{background:"rgba(0, 0, 0, 0)"},attrs:{fluid:!0,"header-level":4},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("\n          Node ID: "+e._s(t.id)+"\n        ")]},proxy:!0},{key:"lead",fn:function(){return[e._v("\n          Stage: "+e._s(e.stages[t.stage].name)+"\n          "),n("br"),e._v("\n          Type: "+e._s(t.type)+"\n        ")]},proxy:!0}],null,!0)},[n("hr",{staticClass:"my-4"}),n("b-button",{attrs:{variant:"success"},on:{click:function(n){return e.verifyNode(t.id)}}},[e._v("Run node")])],1)],1)])})],2)},D=[],N=(n("7f7f"),n("8afe")),M=(n("7514"),n("ac6a"),n("a481"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"flowchart",attrs:{id:"flowchart"}},[n("div",{directives:[{name:"mouseup-outside",rawName:"v-mouseup-outside",value:e.handleUp,expression:"handleUp"},{name:"touch",rawName:"v-touch:moving",value:e.handleTouchMove,expression:"handleTouchMove",arg:"moving"},{name:"touch",rawName:"v-touch:end",value:e.handleUp,expression:"handleUp",arg:"end"},{name:"touch",rawName:"v-touch:start",value:e.handleTouchDown,expression:"handleTouchDown",arg:"start"}],staticClass:"flowchart-container",on:{mousedown:e.handleMouseDown,mousemove:e.handleMouseMove}},[e._l(e.scene.nodes,function(t,s){return n("flowchart-node",e._b({key:"node"+s,ref:"node"+s,refInFor:!0,attrs:{options:e.nodeOptions},on:{linkingStart:function(n){return e.linkingStart(t.id,n)},linkingStop:function(n){return e.linkingStop(t.id)},nodeSelected:function(n){return e.nodeSelected(t.id,n)},verifyNode:function(n){return e.verifyNode(t.id)},openDrawer:function(n){return e.openDrawer(t.id)}}},"flowchart-node",t,!1,!0))}),n("svg",{attrs:{width:"100%",height:e.height+"px"}},[e._l(e.lines(),function(t,s){return n("flowchart-link",e._b({key:"link"+s,on:{deleteLink:function(n){return e.linkDelete(t.id)}}},"flowchart-link",t,!1,!0))}),e._l(e.stages,function(t,s){return n("line",{key:"line-"+s,staticStyle:{stroke:"rgb(100, 100, 100)","stroke-width":"6",cursor:"col-resize"},attrs:{id:"line-"+s,x1:e.calStageWidth(s),y1:"0",x2:e.calStageWidth(s),y2:"100%","stroke-dasharray":"20, 20"}})}),e._l(e.stages,function(t,s){return n("text",{key:"text-"+s,staticStyle:{"font-size":"24px"},attrs:{x:e.calStageWidth(s)+50*e.scene.scale,y:"5%",textLength:"100",lengthAdjust:"spacing"}},[e._v("\n        "+e._s(t.name)+"\n        ")])})],2)],2)])])}),O=[],T=(n("456d"),n("28a5"),n("c93e")),L=(n("f751"),n("6762"),n("2fdb"),n("20d6"),n("9393")),E=(n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mouseover:e.handleMouseOver,mouseleave:e.handleMouseLeave}},[n("path",{staticClass:"path-style",attrs:{d:e.dAttr}}),e.show.delete?n("a",{on:{click:e.deleteLink}},[n("text",{staticClass:"times-style",attrs:{"text-anchor":"middle",transform:e.arrowTransform,"font-size":"30"}},[e._v("×")])]):n("path",{staticClass:"arrow-style",attrs:{d:"M -1 -1 L 0 1 L 1 -1 z",transform:e.arrowTransform}})])}),X=[],B={name:"FlowchartLink",props:{start:{type:Array,default:function(){return[0,0]}},end:{type:Array,default:function(){return[0,0]}},id:Number},data:function(){return{show:{delete:!1}}},methods:{handleMouseOver:function(){this.show.delete=!0},handleMouseLeave:function(){this.show.delete=!1},calculateCenterPoint:function(){var e=(this.end[0]-this.start[0])/2,t=(this.end[1]-this.start[1])/2;return[this.start[0]+e,this.start[1]+t]},calculateRotation:function(){var e=this.end[0]-this.start[0];e=e>10?e*=.2:e;var t=this.end[1]-this.start[1],n=-Math.atan2(e,t),s=180*n/Math.PI;return s<0?s+360:s},deleteLink:function(){this.$emit("deleteLink")}},computed:{arrowTransform:function(){var e=this.calculateCenterPoint(),t=Object(L["a"])(e,2),n=t[0],s=t[1],i=this.calculateRotation();return"translate(".concat(n,", ").concat(s,") rotate(").concat(i,")")},dAttr:function(){var e=this.start[0],t=this.start[1],n=this.end[0],s=this.end[1],i=e,o=t,a=n,r=s;return i+=.8*(n-e),a-=.8*(n-e),"M ".concat(e,", ").concat(t," C ").concat(i,", ").concat(o,", ").concat(a,", ").concat(r,", ").concat(n,", ").concat(s)}}},C=B,I=(n("c0f2"),n("2877")),Y=Object(I["a"])(C,E,X,!1,null,"e58556de",null);Y.options.__file="FlowchartLink.vue";var $=Y.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"touch",rawName:"v-touch:start",value:e.handleMousedown,expression:"handleMousedown",arg:"start"},{name:"touch",rawName:"v-touch:longtap",value:e.handleMouseDouble,expression:"handleMouseDouble",arg:"longtap"}],staticClass:"flowchart-node",class:{selected:e.options.selected===e.id},style:e.nodeStyle,on:{dblclick:e.handleMouseDouble,mousedown:e.handleMousedown,mouseover:e.handleMouseOver,mouseleave:e.handleMouseLeave}},[n("div",{staticClass:"node-port node-input",class:{"node-port-tag":e.stat},on:{mouseup:e.inputMouseUp,mousedown:e.inputMouseDown}}),n("div",{staticClass:"node-main",attrs:{id:"node-main_"+e.id}},["error"===e.stat?n("div",{staticClass:"node-error",attrs:{id:"node-main_"+e.id}},[n("span",[e._v("Error")])]):"warning"===e.stat?n("div",{staticClass:"node-warning",attrs:{id:"node-main_"+e.id}},[n("span",[e._v("Warning")])]):n("div",{staticClass:"node-success",attrs:{id:"node-main_"+e.id}},[n("span",[e._v("Success")])]),n("div",{ref:"nodeType",staticClass:"node-type",attrs:{id:"node-type_"+e.id}},[e._v("\n      "+e._s(e.type)+"\n    ")]),n("div",{staticClass:"node-label",attrs:{id:"label_"+e.id}},[n("div",{ref:"labelTitle",staticClass:"node-label-title",attrs:{id:"label-title_"+e.id}},[n("div",{staticClass:"text-right"},[n("b-button",{attrs:{pill:"",variant:"outline-success"},on:{click:e.onVerifyNode}},[n("font-awesome-icon",{attrs:{icon:["fas","check"],size:"sm"}})],1),e._v("\n           \n          "),n("b-button",{attrs:{pill:"",variant:"outline-success"},on:{click:e.onOpenDrawer}},[n("font-awesome-icon",{attrs:{icon:["fas","cog"],size:"sm"}})],1)],1),e._v("\n        "+e._s(e.label)+"\n      ")]),e.outButtons.length>0?n("div",{staticClass:"node-buttons",attrs:{id:"node-buttons_"+e.id}},e._l(e.outButtons,function(t,s){return n("div",{key:s,staticClass:"node-label-button",attrs:{id:"button_"+e.id+"_"+s}},[n("span",[e._v(e._s(t.text))]),n("div",{staticClass:"node-port node-output",style:e.buttonPortStyle(s),attrs:{id:"port_"+e.id+"_"+s},on:{mousedown:function(t){return e.outputMouseDown(s,t)}}})])}),0):e._e()])]),0===e.outButtons.length?n("div",{staticClass:"node-port node-output",class:{"node-port-tag":e.stat},attrs:{id:"node-output_"+e.id},on:{mousedown:function(t){return e.outputMouseDown(-1,t)}}}):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.show.delete,expression:"show.delete"}],staticClass:"node-delete"},[e._v("×")])])},P=[],W={name:"FlowchartNode",props:{id:{type:Number,default:1e3,validator:function(e){return"number"===typeof e}},centeredX:{type:Number,default:0,validator:function(e){return"number"===typeof e}},centeredY:{type:Number,default:0,validator:function(e){return"number"===typeof e}},type:{type:String,default:"Default"},label:{type:String,default:"node id: "},options:{type:Object,default:function(){return{centerX:1024,scale:1,centerY:140}}},stat:{type:String,default:function(){return"success"}},outButtons:{type:Array,default:function(){return[]}},upStream:{type:Array,default:function(){return[]}}},data:function(){return{show:{delete:!0},linkingStart:!1,reload:!1}},mounted:function(){this.show.delete=!1},computed:{nodeStyle:function(){return{top:this.centeredY*this.options.scale+"px",left:this.centeredX*this.options.scale+"px",transform:"scale(".concat(this.options.scale,")")}}},methods:{buttonPortStyle:function(e){var t=this.$refs.nodeType;if(t){var n=this.$refs.labelTitle;if(n){for(var s=t.offsetHeight,i=n.offsetHeight,o=i+s,a=null,r=e;r>=0;r--)a=document.getElementById("button_"+this.id+"_"+r),a&&(o+=r===e?a.offsetHeight/1.5:a.offsetHeight);var c=0;return null!==this.stat&&(c+=40),o+=c,{top:o+"px",right:"-12px",marginTop:"0px"}}}},handleMousedown:function(e){var t=e.target||e.srcElement;t.matches("svg, svg *")||t.matches("button")||t.className.indexOf("node-input")<0&&t.className.indexOf("node-output")<0&&this.$emit("nodeSelected",e),e.type.includes("mouse")&&e.preventDefault()},handleMouseOver:function(){this.show.delete=!0},handleMouseLeave:function(){this.show.delete=!1},handleMouseDouble:function(){return null},outputMouseDown:function(e,t){t.buttonIndex=e,this.$emit("linkingStart",t),t.type.includes("mouse")&&t.preventDefault()},outputMouseMove:function(e){this.linkingStart&&this.$emit("linkingStart")},outputMouseMoveFromButtonNode:function(e,t){this.linkingStart&&this.$emit("linkingStart",e,t)},outputMouseUp:function(e){this.linkingStart=!1,e.type.includes("mouse")&&e.preventDefault()},inputMouseDown:function(e){e.type.includes("mouse")&&e.preventDefault()},inputMouseUp:function(e){this.$emit("linkingStop"),e.type.includes("mouse")&&e.preventDefault()},onVerifyNode:function(){this.$emit("verifyNode")},onOpenDrawer:function(){this.$emit("openDrawer")}}},F=W,z=(n("7495"),Object(I["a"])(F,j,P,!1,null,"476b7da7",null));z.options.__file="FlowchartNode.vue";var R=z.exports;function A(e){var t=e.getBoundingClientRect(),n=window.pageYOffset,s=window.pageXOffset,i=t.top+n,o=t.left+s;return{top:Math.round(i),left:Math.round(o)}}function H(e,t){var n,s=null;t.type.includes("mouse")?(n=t.pageX||t.clientX+document.documentElement.scrollLeft,s=t.pageY||t.clientY+document.documentElement.scrollTop):(n=t.touches[0].pageX||t.touches[0].clientX+document.documentElement.scrollLeft,s=t.touches[0].pageY||t.touches[0].clientY+document.documentElement.scrollTop);var i=A(e),o=n-i.left,a=s-i.top;return[o,a]}var U={name:"VueFlowchart",props:{scene:{type:Object,default:function(){return{centerX:0,scale:1,centerY:0,nodes:[],links:[]}}},height:{type:Number,default:400},stages:{type:Object,default:function(){return{}}},verifyNode:{type:Function,default:function(){return null}},resetNodeStatFromID:{type:Function,default:function(){return null}},openDrawer:{type:Function,default:function(){return null}}},data:function(){return{action:{linking:!1,dragging:!1,scrolling:!1,movingBound:!1,selected:0,selectedBound:null},mouse:{x:0,y:0,lastX:0,lastY:0},draggingLink:null,rootDivOffset:{top:0,left:0},moving:!1,draggingNodeTop:0,draggingNodeLeft:0,actionType:"",window:{width:0,height:0}}},created:function(){window.addEventListener("resize",this.windowsResize),this.windowsResize()},destroyed:function(){window.removeEventListener("resize",this.windowsResize)},components:{FlowchartLink:$,FlowchartNode:R},computed:{nodeOptions:function(){return{centerY:this.scene.centerY,centerX:this.scene.centerX,scale:this.scene.scale,offsetTop:this.rootDivOffset.top,offsetLeft:this.rootDivOffset.left,selected:this.action.selected}}},mounted:function(){this.rootDivOffset.top=this.$el?this.$el.offsetTop:0,this.rootDivOffset.left=this.$el?this.$el.offsetLeft:0},methods:{calStageWidth:function(e){return parseInt(e)>0?this.stages[e].width=this.stages[e-1].width+this.stages[e-1].widthDelta*this.scene.scale:this.stages[e].width=this.scene.centerX*this.scene.scale,this.stages[e].width},lines:function(){var e=this,t=this.scene.links.map(function(t){var n,s,i,o,a,r,c=e.findNodeWithID(t.from),l=e.findNodeWithID(t.to);n=c.centeredX,s=c.centeredY;var u=e.getPortPosition(c,"right",n,s,t.outButton),d=Object(L["a"])(u,2);o=d[0],i=d[1],n=l.centeredX,s=l.centeredY;var h=e.getPortPosition(l,"left",n,s),f=Object(L["a"])(h,2);return a=f[0],r=f[1],{start:[o,i],end:[a,r],id:t.id}});if(this.draggingLink){var n,s,i,o,a=this.findNodeWithID(this.draggingLink.from);n=a.centeredX,s=a.centeredY;var r=this.getPortPosition(a,"right",n,s,this.draggingLink.buttonIndex),c=Object(L["a"])(r,2);o=c[0],i=c[1],t.push({start:[o,i],end:[this.draggingLink.mx,this.draggingLink.my]})}return t},findNodeWithID:function(e){return this.scene.nodes.find(function(t){return e===t.id})},getPortPosition:function(e,t,n,s,i){var o=document.getElementById("node-main_"+e.id),a=0,r=0;o&&(a=o.offsetHeight,r=o.offsetWidth);var c=0;if(null!==e.stat&&(c+=40),"right"===t){var l=null;if(-1===i)return[(n+r)*this.scene.scale,(s+a/2+c/2-4)*this.scene.scale];l=e.outButtons.findIndex(function(e){return e.id===i});var u=document.getElementById("node-type_".concat(e.id));if(!u)return[0,0];var d=document.getElementById("label-title_".concat(e.id));if(!d)return[0,0];for(var h=u.offsetHeight,f=d.offsetHeight,m=f+h,p=null,g=l;g>=0;g--)p=document.getElementById("button_"+e.id+"_"+g),p&&(m+=g===l?p.offsetHeight/1.5:p.offsetHeight);return m+=c,[(n+r)*this.scene.scale,(s+m)*this.scene.scale]}if("left"===t)return[n*this.scene.scale,(s+a/2+c/2-4)*this.scene.scale]},linkingStart:function(e,t){this.action.linking=!0;var n,s=null;if(t.type.includes("mouse")){var i=H(this.$el,t),o=Object(L["a"])(i,2);n=o[0],s=o[1]}else{var a=H(this.$el,t),r=Object(L["a"])(a,2);n=r[0],s=r[1]}this.draggingLink={from:e,buttonIndex:t.buttonIndex,mx:n,my:s}},linkingStop:function(e){var t=this;if(this.draggingLink&&this.draggingLink.from!==e){var n=this.scene.links.find(function(n){return n.from===t.draggingLink.from&&n.to===e&&(-1===n.outButton||n.outButton===t.findNodeWithID(n.from).outButtons[t.draggingLink.buttonIndex].id)}),s=this.findNodeWithID(this.draggingLink.from),i=this.findNodeWithID(e),o=Math.abs(s.stage-i.stage)<=1;if(!n&&o){var a=Math.max.apply(Math,[-1].concat(Object(N["a"])(this.scene.links.map(function(e){return e.id})))),r=s.outButtons&&s.outButtons.length?s.outButtons[this.draggingLink.buttonIndex].id:-1,c={id:a+1,from:this.draggingLink.from,to:e,outButton:r};if(i.upStream.push({id:this.draggingLink.from,button:r}),this.cyclicExist())return i.upStream.pop(),void(this.draggingLink=null);this.scene.links.push(c),i.stat="warning",this.resetNodeStatFromID(e),this.$emit("linkAdded",c)}}this.draggingLink=null},linkDelete:function(e){var t=this,n=this.scene.links.find(function(t){return t.id===e});if(n){var s=this.scene.links.findIndex(function(t){return t.id===e}),i=this.findNodeWithID(this.scene.links[s].to);i.upStream=i.upStream.filter(function(e){return e.id!==t.scene.links[s].from||e.button!==t.scene.links[s].outButton}),i.stat="warning",this.resetNodeStatFromID(this.scene.links[s].to),this.scene.links.splice(s,1),this.$emit("linkBreak",n)}},cyclicExist:function(){var e=[],t=[];this.scene.nodes.forEach(function(n){n.upStream.length<1?e.push(Object.assign({},n)):t.push(Object.assign({},n))});var n=function(){var n=e.pop(),s=[];t.forEach(function(t){t.upStream=t.upStream.filter(function(e){return e.id!==n.id}),t.upStream.length<1?e.push(t):s.push(t)}),t=s};while(e.length>0)n();return t.length>0},nodeSelected:function(e,t){this.action.dragging=!0,this.action.selected=e,this.$emit("nodeClick",e),t.type.includes("mouse")?(this.mouse.lastX=t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouse.lastY=t.pageY||t.clientY+document.documentElement.scrollTop):(this.mouse.lastX=t.touches[0].pageX||t.touches[0].clientX+document.documentElement.scrollLeft,this.mouse.lastY=t.touches[0].pageY||t.touches[0].clientY+document.documentElement.scrollTop)},handleMove:function(e){var t=this;if(this.action.linking){var n=H(this.$el,e),s=Object(L["a"])(n,2);this.mouse.x=s[0],this.mouse.y=s[1],e.type.includes("mouse")?(this.mouse.x=e.pageX||e.clientX+document.documentElement.scrollLeft,this.mouse.y=e.pageY||e.clientY+document.documentElement.scrollTop):(this.mouse.x=e.touches[0].pageX||e.touches[0].clientX+document.documentElement.scrollLeft,this.mouse.y=e.touches[0].pageY||e.touches[0].clientY+document.documentElement.scrollTop);var i=document.getElementById("app").scrollTop,o=document.getElementById("title").offsetHeight+22+87,a=[this.mouse.x,this.mouse.y-o+i];this.draggingLink.mx=a[0],this.draggingLink.my=a[1]}if(this.action.dragging){e.type.includes("mouse")?(this.mouse.x=e.pageX||e.clientX+document.documentElement.scrollLeft,this.mouse.y=e.pageY||e.clientY+document.documentElement.scrollTop):(this.mouse.x=e.touches[0].pageX||e.touches[0].clientX+document.documentElement.scrollLeft,this.mouse.y=e.touches[0].pageY||e.touches[0].clientY+document.documentElement.scrollTop);var r=this.mouse.x-this.mouse.lastX,c=this.mouse.y-this.mouse.lastY;this.mouse.lastX=this.mouse.x,this.mouse.lastY=this.mouse.y,this.moveSelectedNode(r,c)}if(this.action.scrolling){var l=H(this.$el,e),u=Object(L["a"])(l,2);this.mouse.x=u[0],this.mouse.y=u[1];var d=this.mouse.x-this.mouse.lastX,h=this.mouse.y-this.mouse.lastY;this.mouse.lastX=this.mouse.x,this.mouse.lastY=this.mouse.y,this.scene.centerX+=d/this.scene.scale,this.scene.centerY+=h/this.scene.scale,this.scene.nodes=this.scene.nodes.map(function(e){return Object(T["a"])({},e,{centeredX:e.centeredX+d/t.scene.scale,centeredY:e.centeredY+h/t.scene.scale})})}if(this.action.movingBound){var f=H(this.$el,e),m=Object(L["a"])(f,2);this.mouse.x=m[0],this.mouse.y=m[1];var p=(this.mouse.x-this.mouse.lastX)/this.scene.scale;this.mouse.lastX=this.mouse.x,this.action.selectedBound>0&&this.stages[this.action.selectedBound-1].width-p+200*this.scene.scale<this.stages[this.action.selectedBound].width&&(this.stages[this.action.selectedBound-1].widthDelta+=p,Object(N["a"])(Array(this.scene.nodes.length).keys()).forEach(function(e){t.scene.nodes[e].stage>=t.action.selectedBound?t.$set(t.scene.nodes,e,Object.assign(t.scene.nodes[e],{centeredX:t.scene.nodes[e].centeredX+p,centeredY:t.scene.nodes[e].centeredY})):(t.scene.nodes[e].centeredX+200)*t.scene.scale>t.calStageWidth(t.action.selectedBound)&&t.$set(t.scene.nodes,e,Object.assign(t.scene.nodes[e],{centeredX:t.calStageWidth(t.action.selectedBound)/t.scene.scale-200,centeredY:t.scene.nodes[e].centeredY}))}))}},handleUp:function(e){var t=e.target||e.srcElement;this.$el.contains(t)&&(("string"!==typeof t.className||t.className.indexOf("node-input")<0)&&(this.draggingLink=null),"string"===typeof t.className&&t.className.indexOf("node-delete")>-1&&this.nodeDelete(this.action.selected)),this.action.linking=!1,this.action.dragging=!1,this.action.scrolling=!1,this.action.movingBound=!1,this.action.selected=null,this.action.selectedBound=null},handleDown:function(e){var t=e.target||e.srcElement;if(t===this.$el||t.matches("line, line *")){this.action.selectedBound=t.id.split("-")[1],this.action.selectedBound>0?this.action.movingBound=!0:this.action.scrolling=!0;var n=H(this.$el,e),s=Object(L["a"])(n,2);this.mouse.lastX=s[0],this.mouse.lastY=s[1],this.action.selected=null}else if(t===this.$el||t.matches("svg, svg *")){this.action.scrolling=!0;var i=H(this.$el,e),o=Object(L["a"])(i,2);this.mouse.lastX=o[0],this.mouse.lastY=o[1],this.action.selected=null}this.$emit("canvasClick",e)},handleMouseMove:function(e){e.type.includes("mouse")&&this.handleMove(e)},handleMouseDown:function(e){e.type.includes("mouse")&&this.handleDown(e)},handleTouchMove:function(e){e.type.includes("touch")&&this.handleMove(e)},handleTouchDown:function(e){e.type.includes("touch")&&this.handleDown(e)},moveSelectedNode:function(e,t){var n=this,s=this.scene.nodes.findIndex(function(e){return e.id===n.action.selected}),i=this.scene.nodes[s].centeredX+e/this.scene.scale,o=this.scene.nodes[s].centeredY+t/this.scene.scale;this.scene.nodes[s].stage+1<Object.keys(this.stages).length&&(i=Math.min(i,this.calStageWidth(this.scene.nodes[s].stage+1)/this.scene.scale-200)),i=Math.max(i,this.calStageWidth(this.scene.nodes[s].stage)/this.scene.scale),this.$set(this.scene.nodes,s,Object.assign(this.scene.nodes[s],{centeredX:i,centeredY:o}))},nodeDelete:function(e){var t=this;this.scene.links.forEach(function(n){if(n.from===e){var s=t.findNodeWithID(n.to);s.upStream=s.upStream.filter(function(t){return t.id!==e})}});var n=this.scene.links.filter(function(t){return t.from===e||t.to===e});n.forEach(function(e){t.linkDelete(e.id)}),this.scene.nodes=this.scene.nodes.filter(function(t){return t.id!==e}),this.$emit("nodeDelete",e)},windowsResize:function(){this.window.width=window.innerWidth,this.window.height=window.innerHeight}}},V=U,q=(n("5f6a"),Object(I["a"])(V,M,O,!1,null,"5ccea7e8",null));q.options.__file="SimpleFlowchart.vue";var J=q.exports,Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.enabled?n("section",[n("aside",{ref:"element",staticClass:"sidebar",style:e.style},[e._t("default")],2),n("div",{ref:"overlay",staticClass:"overlay"})]):e._e()},G=[],K={props:["direction","exist"],data:function(){return{auto_speed:"0.3s",manual_speed:"0.03s",threshold:20,startTime:null,startPos:null,translate:null,active:!1,visible:!0}},computed:{element:function(){return this.$refs.element},overlay:function(){return this.$refs.overlay},enabled:function(){return 1==this.exist},style:function(){return"right"==this.direction?"transform:translate3d(100%,0,0);right:0;":"transform:translate3d(-100%,0,0);left:0;"}},mounted:function(){var e=this;document.addEventListener("touchstart",function(t){e.handleStart(t)}),document.addEventListener("touchmove",function(t){e.handleMove(t)}),document.addEventListener("touchend",function(t){e.handleEnd(t)}),document.addEventListener("touchcancel",function(t){e.handleEnd(t)}),window.addEventListener("resize",function(t){e.setVisibality(t)},!0),this.overlay.addEventListener("transitionend",function(t){e.handleZindex(t)},!1),this.overlay.addEventListener("click",function(){e.close()},!1),this.setVisibality()},methods:{setVisibality:function(){0==this.element.offsetWidth?this.visible=!1:this.visible=!0},handleStart:function(e){this.startTime=(new Date).getTime(),this.startPos=e.targetTouches[0].pageX,this.element.style.transitionDuration=this.manual_speed},handleMove:function(e){var t=this.gesture(e),n=this.validate(this.direction,t);if(n){var s=this.percentage(this.direction,t);"left"==this.direction?(this.translate=e.touches[0].pageX-this.element.offsetWidth,this.translate<0?this.element.style.transform="translate3d("+this.translate+"px,0,0)":this.open()):(this.translate=-(screen.width-this.element.offsetWidth-e.touches[0].pageX),this.translate>0?this.element.style.transform="translate3d("+this.translate+"px,0,0)":this.open()),this.overlayOpacity(s/100)}},handleEnd:function(e){var t=this.speed(e),n=this.gesture(e),s=this.validate(this.direction,n);s&&(t>.6?this.active?this.close():this.open():this.element.offsetWidth/2>Math.abs(this.translate)?this.open():this.close())},handleZindex:function(){var e=window.getComputedStyle(this.overlay).getPropertyValue("opacity");e<=0&&(this.overlay.style.zIndex=-999)},validate:function(e,t){if("left"==e){if(this.active&&"swiperight"==t||!this.active&&("swipeleft"==t||this.startPos>this.threshold))return!1}else if(this.active&&"swipeleft"==t||!this.active&&("swiperight"==t||this.startPos<screen.width-this.threshold))return!1;return!(document.querySelector(".sidebar.active")&&!this.active||!this.visible)},overlayOpacity:function(e){this.overlay.style.opacity=e,e>0&&(this.overlay.style.zIndex=999)},gesture:function(e){var t=["swipeleft","swiperight"],n=e.changedTouches[0].pageX;return this.startPos-n<0?t[1]:t[0]},open:function(){this.translate=0,this.element.style.transform="translate3d("+this.translate+",0,0)",this.element.style.transitionDuration=this.auto_speed,this.overlayOpacity(1),this.lock(document.querySelector("html")),this.lock(document.querySelector("body")),this.element.classList.add("active"),this.active=!0},close:function(){"left"==this.direction?this.translate="-"+window.screen.width+"px":this.translate=window.screen.width+"px",this.element.style.transform="translate3d("+this.translate+",0,0)",this.element.style.transitionDuration=this.auto_speed,this.overlayOpacity(0),this.unlock(document.querySelector("html")),this.unlock(document.querySelector("body")),this.element.classList.remove("active"),this.active=!1},speed:function(e){var t=(new Date).getTime()-this.startTime,n=Math.abs(this.startPos),s=Math.abs(e.changedTouches[0].pageX),i=n>s?n-s:s-n;return i/t},percentage:function(e,t){var n=0,s=[];return s="left"==e?["swipeleft","swiperight"]:["swiperight","swipeleft"],this.active&&t==s[0]&&(n=100-Math.round(Math.abs(this.translate)/this.element.offsetWidth*100)),this.active||t!=s[1]||(n=Math.round(100-Math.abs(this.translate)/this.element.offsetWidth*100)),n>100&&(n=100),n<0&&(n=0),n},lock:function(e){e.style.overflow="hidden",e.style.touchAction="none"},unlock:function(e){e.style.removeProperty("overflow"),e.style.removeProperty("touch-action")}}},Q=K,ee=(n("b286"),Object(I["a"])(Q,Z,G,!1,null,"e8428944",null));ee.options.__file="Drawer.vue";var te=ee.exports,ne={name:"app",components:{SimpleFlowchart:J,Drawer:te},data:function(){return{isRawScene:!1,isPanelShow:!1,scene:{centerX:50,centerY:0,scale:1,nodes:[],links:[]},newNodeType:null,nodeCategory:[{name:"nodeType1",stage:0,start:!0,outButtons:[]},{name:"nodeType2",stage:1,start:!1,outButtons:[]},{name:"nodeType3",stage:2,start:!1,outButtons:[{id:0,text:"Option 1"},{id:1,text:"Option 2"},{id:2,text:"Option 3"}]},{name:"nodeType4",stage:2,start:!1,outButtons:[]},{name:"nodeType5",stage:2,start:!1,outButtons:[]},{name:"nodeType6",stage:2,start:!1,outButtons:[]},{name:"nodeType7",stage:3,start:!1,outButtons:[]}],newStageType:null,stages:{0:{name:"stage1",width:0,widthDelta:500},1:{name:"stage2",width:0,widthDelta:500},2:{name:"stage3",width:0,widthDelta:500},3:{name:"stage4",width:0,widthDelta:500}}}},computed:{prettyScene:function(){return JSON.stringify(this.scene,null,"\t").replace(/\n/gi,"<br />").replace(/\t/gi,"&nbsp;&nbsp;")},rawScene:function(){return JSON.stringify(this.scene)}},methods:{nodeInStage:function(e){return this.nodeCategory.filter(function(t){return t.stage===e})},verifyNode:function(e){var t=this,n=this.findNodeWithID(e);0!==n.upStream.length||n.start?(n.stat="success",n.upStream.forEach(function(e){"success"!==t.findNodeWithID(e.id).stat&&(n.stat="error")})):(n.stat="error",this.resetNodeStatFromID(n.id,"error"))},resetNodeStatFromID:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";this.scene.nodes.forEach(function(s){s.upStream.forEach(function(i){i.id===e&&(s.stat=n,t.resetNodeStatFromID(s.id))})})},findNodeWithID:function(e){return this.scene.nodes.find(function(t){return e===t.id})},canvasClick:function(e){},addNode:function(e){var t=Math.max.apply(Math,[-1].concat(Object(N["a"])(this.scene.nodes.map(function(e){return e.id})))),n=this.nodeInStage(parseInt(this.newStageType));this.scene.nodes.push({id:t+1,centeredX:this.stages[n[this.newNodeType].stage].width/this.scene.scale,centeredY:this.scene.centerY+50,type:n[this.newNodeType].name,stage:n[this.newNodeType].stage,label:"node id: ".concat(t+1),start:n[this.newNodeType].start,outButtons:n[this.newNodeType].outButtons,stat:e,upStream:[],param:{}})},nodeClick:function(e){},nodeDelete:function(e){},linkBreak:function(e){},linkAdded:function(e){},onCreateFormSubmit:function(e){e.preventDefault(),this.addNode("warning"),this.newNodeType=null,this.$refs.createModal.hide()},onCreateFormReset:function(e){e.preventDefault(),this.newNodeType=null,this.$refs.createModal.hide()},openDrawer:function(e){this.$refs["drawer_"+e][0].active?this.$refs["drawer_"+e][0].close():this.$refs["drawer_"+e][0].open()}}},se=ne,ie=(n("5c0b"),Object(I["a"])(se,x,D,!1,null,null,null));ie.options.__file="App.vue";var oe=ie.exports;s["a"].config.productionTip=!1,s["a"].use(c["a"]),s["a"].use(l["a"]),s["a"].use(u["a"]),s["a"].use(d["a"]),s["a"].use(h["a"]),s["a"].use(f["a"]),s["a"].use(m["a"]),s["a"].use(p["a"]),s["a"].use(g["a"]),s["a"].use(v["a"]),s["a"].use(y["a"]),s["a"].use(w["a"]),s["a"].use(b["a"]),s["a"].use(o.a),s["a"].use(r.a),k["c"].add(_["a"]),k["c"].add(_["b"]),k["c"].add(_["c"]),s["a"].component("font-awesome-icon",S["a"]),new s["a"]({render:function(e){return e(oe)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var s=n("2856"),i=n.n(s);i.a},"5cf2":function(e,t,n){},"5f6a":function(e,t,n){"use strict";var s=n("b537"),i=n.n(s);i.a},7495:function(e,t,n){"use strict";var s=n("24c7"),i=n.n(s);i.a},"7bf6":function(e,t,n){},b286:function(e,t,n){"use strict";var s=n("7bf6"),i=n.n(s);i.a},b537:function(e,t,n){},c0f2:function(e,t,n){"use strict";var s=n("5cf2"),i=n.n(s);i.a}});
//# sourceMappingURL=app.374eafe6.js.map